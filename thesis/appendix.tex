\chapter{Source code for calculations}
The author wrote some code in the computer algebra system Sage
in order to help verify the correctness of elementary calculations done in this paper.
For the convenience of the reader, the code is provided below.

\section{Orbital integral formula and its derivative for the group AFL}

\section{Orbital integral formula and its derivative for the semi-Lie AFL}
This code implements the following functions and correctness checks.
\begin{itemize}
  \ii The function \texttt{O(r, vb, vc, ve, vda)}
  corresponds to the formula in \Cref{thm:semi_lie_formula}.
  \ii The function \texttt{delO\_combo(r, vb, vc, ve, vda)}
  corresponds to the formula in \Cref{cor:semi_lie_combo},
  except for the $\log q$ factor.
  \ii The function \texttt{verify\_O\_correct()}
  runs randomized instantiations of \texttt{O(r, vb, vc, ve, vda)}
  against the summations as they are described in \Cref{ch:orbitalFJ1}
  and checks that the resulting polynomials are equal for the random values
  $q = 17$ and $s = \log_q 1337$.
  \ii The function \texttt{verify\_delO\_combo\_correct()}
  runs randomized instances of
  function \texttt{delO\_combo(r, vb, vc, ve, vda)}
  and verifies that they equal the actual value of the derivative
  when computed from differentiating \texttt{O(r, vb, vc, ve, vda)} within Sage.
\end{itemize}

\lstinputlisting[language=Python]{sage-semi-lie.sage}
